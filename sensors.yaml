
# https://www.home-assistant.io/components/sensor.darksky/
- platform: darksky
  api_key: !secret dark_sky_api_key
  forecast:
    - 1
    - 2
    - 3
    - 4
    - 5
  monitored_conditions:
    - summary
    - icon
    - precip_probability
    - temperature
    - apparent_temperature
    - wind_speed
    - wind_bearing
    - humidity
    - pressure
    - visibility
    - hourly_summary
    - daily_summary
    - temperature_high
    - temperature_low
    #- uv_index  # not currently being used by Lovelace weather card
## other Dark Sky conditions, none of which are being used by Lovelace weather card
    #- precip_type
    #- precip_intensity
    #- precip_accumulation
    #- precip_intensity_max
    #- dew_point
    #- minutely_summary
    #- apparent_temperature_high
    #- apparent_temperature_low
    #- moon_phase
    #- nearest_storm_distance
    #- nearest_storm_bearing
    #- wind_gust
    #- cloud_cover
    #- ozone
  update_interval:
    minutes: 5

- platform: template
  sensors:
    nextsunrise:
      friendly_name: 'Next Sunrise'
      value_template: '{{ as_timestamp(states.sun.sun.attributes.next_rising) | timestamp_custom("%a %I:%M%p") }}'

    nextsunset:
      friendly_name: 'Next Sunset'
      value_template: '{{ as_timestamp(states.sun.sun.attributes.next_setting) | timestamp_custom("%a %I:%M%p") }}'


# PocketCasts
# Currently not working: https://github.com/home-assistant/home-assistant/issues/16103
#- platform: pocketcasts
  #username: ben@benjamincharity.com
  #password: !secret pocketcasts_password

# Fast.com
- platform: fastdotcom

# Google Travel Time
- platform: google_travel_time
  id: commute-ben-work
  name: Home to work Ben
  api_key: !secret google_api_key
  origin: zone.home
  destination: zone.work_ben

- platform: google_travel_time
  id: commute-ben-home
  name: Work to home Ben
  api_key: !secret google_api_key
  origin: zone.work_ben
  destination: zone.home

# MARTA
#- platform: gtfs
  #origin: !secret marta_lindberg
  #destination: !secret marta_peachtree
  #data: marta.zip
  #name: 'MARTA Train Times'

# Plex
- platform: plex
  id: plex
  host: !secret plex_host
  token: !secret plex_token
  port: !secret plex_port



# Crime
#- platform: crimereports
  #name: Home Crime Report
  #radius: 1000
  #latitude: !secret home_lat
  #longitude: !secret home_long


# Thermostat Away Mode
- platform: template
  sensors:
    hallway_thermostat_away_mode:
      value_template: >
        {% if is_state_attr('climate.hallway', 'away_mode', 'off') %}
          Home
        {% else %}
          Away
        {% endif %}


# Benjamin Presence
- platform: template
  sensors:
    benjamin_presence_sensor:
      value_template: >
        {% if is_state_attr('binary_sensor.benjamin_presence', 'state', 'off') %}
          Away
        {% else %}
          Home
        {% endif %}

# Anna Presence
- platform: template
  sensors:
    anna_presence_sensor:
      value_template: >
        {% if is_state_attr('binary_sensor.anna_presence', 'state', 'off') %}
          Away
        {% else %}
          Home
        {% endif %}


- platform: history_stats
  name: Total TV Time Living Room
  entity_id: media_player.family_room_3
  state: 'playing'
  type: time
  start: '{{ now().replace(hour=0).replace(minute=0).replace(second=0) }}'
  end: '{{ now() }}'

# Working example:
#- platform: history_stats
  #name: Lamp ON today
  #entity_id: light.tv
  #state: 'on'
  #type: time
  #start: '{{ now().replace(hour=0).replace(minute=0).replace(second=0) }}'
  #end: '{{ now() }}'
  #


########################################
# Outside temperature
########################################
- platform: template
  sensors:
    outside_temperature:
      value_template: >
        {{ (states.sensor.hue_motion_sensor_motion_01.attributes.temperature * 9 / 5 ) + 32 | round(2) }}
      unit_of_measurement: 'F'
